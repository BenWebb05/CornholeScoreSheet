<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cornhole Tracker</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f4;
      margin: 0;
      padding: 20px;
      text-align: center;
    }
    .hidden { display: none; }
    button { padding: 5px 10px; margin: 2px; cursor: pointer; }
    input[type="number"] { width: 40px; text-align: center; }
    .round-table {
      margin: 20px auto;
      width: 95%;
      max-width: 1000px;
      background: white;
      border-collapse: collapse;
    }
    .round-table th, .round-table td {
      border: 1px solid #ccc;
      padding: 10px;
      vertical-align: middle;
      text-align: center;
    }
    .input-group {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 4px;
    }
    .team-separator {
      border-left: 3px solid #888;
    }
  </style>
</head>
<body>
  <div id="home">
    <h1>Cornhole Game Tracker</h1>
    <button onclick="showScreen('soloSetup')">ğŸ¯ Solo</button>
    <button onclick="showScreen('teamSetup')">ğŸ¤ Teams</button>
    <button onclick="showScreen('historyLogin')">ğŸ“œ History</button>
 <p style="margin-top: 30px; font-size: 0.9em; color: #555;">This took longer than expected, Enjoy it â€“ Ben :)</p>
  </div>

  <div id="soloSetup" class="hidden">
    <h2>Solo Setup</h2>
    <input id="soloP1" placeholder="Player 1" />
    <input id="soloP2" placeholder="Player 2" />
    <button onclick="startSoloGame()">âœ… Start Game</button>
    <button onclick="showScreen('home')">ğŸ”™ Back</button>
  </div>

  <div id="teamSetup" class="hidden">
    <h2>Team Setup</h2>
    <input id="team1P1" placeholder="Team 1 - Player 1" />
    <input id="team1P2" placeholder="Team 1 - Player 2" />
    <input id="team2P1" placeholder="Team 2 - Player 1" />
    <input id="team2P2" placeholder="Team 2 - Player 2" />
    <button onclick="startTeamGame()">âœ… Start Game</button>
    <button onclick="showScreen('home')">ğŸ”™ Back</button>
  </div>

  <div id="historyLogin" class="hidden">
    <h2>Enter Passcode</h2>
    <input type="password" id="historyPass" />
    <button onclick="checkPasscode()">ğŸ”“ Submit</button>
    <button onclick="showScreen('home')">ğŸ”™ Back</button>
    <div id="historyError" style="color:red"></div>
  </div>

  <div id="historyPage" class="hidden">
    <div id="clearHistoryError" style="color:red"></div>
    <h2>ğŸ“œ Game History</h2>
    <div id="historyList"></div>
    <button onclick="showScreen('home')">ğŸ”™ Back</button>
  </div>

  <div id="teamGame" class="hidden"></div>
  <div id="soloGame" class="hidden"></div>

  <script>

// ==================== Shared Functions ====================
const history = JSON.parse(localStorage.getItem('cornholeHistory') || '[]');

function showScreen(id) {
  document.querySelectorAll('body > div').forEach(div => div.classList.add('hidden'));
  document.getElementById(id).classList.remove('hidden');
}

function checkPasscode() {
  const pass = document.getElementById('historyPass').value;
  if (pass === '010623') {
    showScreen('historyPage');
    renderHistory();
  } else {
    document.getElementById('historyError').textContent = 'Incorrect passcode';
  }
}

function renderHistory() {
  const list = document.getElementById('historyList');
  if (!history.length) {
    list.innerHTML = '<p>No games found.</p>';
    return;
  }
  list.innerHTML = `<button onclick="clearHistory()">ğŸ—‘ï¸ Clear History</button>` +
    history.map(h => `
    <div>
      <h4>${h.summary}</h4>
      <pre>${h.details}</pre>
    </div>`).join('');
}

// ================= SOLO GAME =================
let soloState = {
  players: [],
  rounds: [],
  forceLock: false
};

function startSoloGame() {
  const p1 = document.getElementById('soloP1').value.trim();
  const p2 = document.getElementById('soloP2').value.trim();
  if (!p1 || !p2) return alert('Please enter both player names.');
  soloState.players = [p1, p2];
  soloState.rounds = [];
  soloState.forceLock = false;
  addSoloRound();
  renderSoloGame();
  showScreen('soloGame');
}

function addSoloRound() {
  soloState.rounds.push({ p0Pts: 0, p1Pts: 0, p0Corn: 0, p1Corn: 0, p04b: false, p14b: false });
  renderSoloGame();
}

function updateSolo(i, key, value) {
  soloState.rounds[i][key] = isNaN(value) ? 0 : +value;
  renderSoloGame();
}

function changeSolo(i, key, delta) {
  soloState.rounds[i][key] = (soloState.rounds[i][key] || 0) + delta;
  renderSoloGame();
}

function toggleSolo4Bagger(i, player) {
  const key = `p${player}4b`;
  soloState.rounds[i][key] = !soloState.rounds[i][key];
  renderSoloGame();
}

function resetSoloGame() {
  if (confirm('Reset solo game?')) startSoloGame();
}

function editSoloNames() {
  showScreen('soloSetup');
}

function toggleSoloLockRounds() {
  soloState.forceLock = !soloState.forceLock;
  renderSoloGame();
}

function completeSoloGame() {
  if (!confirm('Are you sure the game is complete?')) return;
  const { players, rounds } = soloState;
  const summary = `${players[0]} vs ${players[1]}`;
  let details = 'Round | ' + players[0] + ' (PNT/CH) | ' + players[1] + ' (PNT/CH) | Score | 4-Baggers\n';
  let cumulative = [0, 0];
  rounds.forEach((r, i) => {
    cumulative[0] += r.p0Pts;
    cumulative[1] += r.p1Pts;
    const baggers = `${r.p04b ? 'â­' : ''} | ${r.p14b ? 'â­' : ''}`;
    details += `${i + 1}     | ${r.p0Pts}/${r.p0Corn}         | ${r.p1Pts}/${r.p1Corn}         | ${cumulative[0]} - ${cumulative[1]} | ${baggers}
`;
  });
  const playerTotals = players.map((_, i) => {
    const pnt = rounds.reduce((sum, r) => sum + (r[`p${i}Pts`] || 0), 0);
    const ch = rounds.reduce((sum, r) => sum + (r[`p${i}Corn`] || 0), 0);
    return `${players[i]}: ${pnt} PNTS, ${ch} CH`;
  }).join("\n");
  details += `
Total: ${cumulative[0]} vs ${cumulative[1]}

${playerTotals}`;
  history.push({ summary, details });
  localStorage.setItem('cornholeHistory', JSON.stringify(history));
  alert('Game logged to history!');
  showScreen('home');
}

function renderSoloGame() {
  const { players, rounds, forceLock } = soloState;
  const unlockedIndex = rounds.length - 1;
  let html = `
    <h2>${players[0]} vs ${players[1]}</h2>
    <button onclick="resetSoloGame()">ğŸ”„ Reset</button>
    <button onclick="editSoloNames()">âœï¸ Edit Names</button>
    <button onclick="toggleSoloLockRounds()">
      ${forceLock ? 'ğŸ”’ Lock All Rounds' : 'ğŸ”“ Unlock All Rounds'}</button>
    <button onclick="completeSoloGame()">âœ… Complete Game</button>
    <table class="round-table">
      <thead>
        <tr><th>Round</th><th>${players[0]}</th><th>${players[1]}</th></tr>
      </thead>
      <tbody>`;

  rounds.forEach((r, i) => {
    const locked = forceLock ? false : i < unlockedIndex;
    html += `<tr>
      <td>${i + 1}</td>
      ${[0, 1].map(p => `
        <td>
          <div><strong>PNT</strong></div>
          <div class='input-group'>
            <button onclick='changeSolo(${i},"p${p}Pts",-1)' ${locked ? 'disabled' : ''}>-</button>
            <input type='number' value='${r[`p${p}Pts`]}' onchange='updateSolo(${i},"p${p}Pts",this.value)' ${locked ? 'disabled' : ''}>
            <button onclick='changeSolo(${i},"p${p}Pts",1)' ${locked ? 'disabled' : ''}>+</button>
          </div>
          <div><strong>CH</strong></div>
          <div class='input-group'>
            <button onclick='changeSolo(${i},"p${p}Corn",-1)' ${locked ? 'disabled' : ''}>-</button>
            <input type='number' value='${r[`p${p}Corn`]}' onchange='updateSolo(${i},"p${p}Corn",this.value)' ${locked ? 'disabled' : ''}>
            <button onclick='changeSolo(${i},"p${p}Corn",1)' ${locked ? 'disabled' : ''}>+</button>
          </div>
          <label><input type='checkbox' ${r[`p${p}4b`] ? 'checked' : ''} onchange='toggleSolo4Bagger(${i},${p})' ${locked ? 'disabled' : ''}/>â­</label>
        </td>`).join('')}
    </tr>`;
  });

  
  html += `</tbody>
    <tfoot>`;
  if (rounds.length >= 5) {
    html += `
      <tr>
        <td></td>
        <td><strong>${players[0]}</strong></td>
        <td><strong>${players[1]}</strong></td>
      </tr>`;
  }
  html += `
      <tr>
        <td>Total</td>
        ${[0, 1].map(p => {
          const pts = rounds.reduce((sum, r) => sum + (+r[`p${p}Pts`] || 0), 0);
          const corn = rounds.reduce((sum, r) => sum + (+r[`p${p}Corn`] || 0), 0);
          const baggers = rounds.filter(r => r[`p${p}4b`]).length;
          return `<td>${pts} PNTS<br>${corn} CH<br>${baggers} â­</td>`;
        }).join('')}
      </tr>
    </tfoot>
  </table>
<br>
<button onclick="addSoloRound()">â• Add Round</button>`;
  document.getElementById('soloGame').innerHTML = html;
}
// ================= TEAM GAME =================
let teamState = {
  players: [],
  rounds: [],
  forceLock: false
};

function startTeamGame() {
  const p = [
    document.getElementById('team1P1').value.trim(),
    document.getElementById('team1P2').value.trim(),
    document.getElementById('team2P1').value.trim(),
    document.getElementById('team2P2').value.trim()
  ];
  if (p.some(name => !name)) return alert('Enter all 4 player names');
  teamState.players = p;
  teamState.rounds = [];
  teamState.forceLock = false;
  addTeamRound();
  renderTeamGame();
  showScreen('teamGame');
}

function addTeamRound() {
  teamState.rounds.push(Array(8).fill(0));
  renderTeamGame();
}

function changeTeam(i, p, d) {
  teamState.rounds[i][p] += d;
  renderTeamGame();
}

function toggleTeamLockRounds() {
  teamState.forceLock = !teamState.forceLock;
  renderTeamGame();
}

function resetTeamGame() {
  if (confirm('Reset team game?')) startTeamGame();
}

function editTeamNames() {
  showScreen('teamSetup');
}

function completeTeamGame() {
  if (!confirm('Are you sure the game is complete?')) return;
  const { players, rounds } = teamState;
  const summary = `${players[0]} & ${players[1]} vs ${players[2]} & ${players[3]}`;
  let details = 'Round | ' + players.slice(0, 4).map(p => p + ' (PNT/CH)').join(' | ') + ' | Score\n';
  let cumulative = [0, 0];
  rounds.forEach((r, i) => {
    const team1Total = r[0] + r[2];
    const team2Total = r[4] + r[6];
    cumulative[0] += team1Total;
    cumulative[1] += team2Total;
    details += `${i + 1}     | ${r[0]}/${r[1]} | ${r[2]}/${r[3]} | ${r[4]}/${r[5]} | ${r[6]}/${r[7]} | ${cumulative[0]} - ${cumulative[1]}
`;
  });
  const totalTeam1 = rounds.reduce((s, r) => s + r[0] + r[2], 0);
  const totalTeam2 = rounds.reduce((s, r) => s + r[4] + r[6], 0);
  const playerTotals = players.map((_, i) => {
    const pnt = rounds.reduce((sum, r) => sum + (r[i * 2] || 0), 0);
    const ch = rounds.reduce((sum, r) => sum + (r[i * 2 + 1] || 0), 0);
    return `${players[i]}: ${pnt} PNTS, ${ch} CH`;
  }).join("\n");
  details += `
Total: ${cumulative[0]} vs ${cumulative[1]}

${playerTotals}`;
  history.push({ summary, details });
  localStorage.setItem('cornholeHistory', JSON.stringify(history));
  alert('Game logged to history!');
  showScreen('home');
}

function renderTeamGame() {
  const { players, rounds, forceLock } = teamState;
  const unlockedIndex = rounds.length - 1;
  let html = `
    <h2>${players[0]} & ${players[1]} vs ${players[2]} & ${players[3]}</h2>
    <button onclick="resetTeamGame()">ğŸ”„ Reset</button>
    <button onclick="editTeamNames()">âœï¸ Edit Names</button>
    <button onclick="toggleTeamLockRounds()">
      ${forceLock ? 'ğŸ”’ Lock All Rounds' : 'ğŸ”“ Unlock All Rounds'}</button>
    <button onclick="completeTeamGame()">âœ… Complete Game</button>
    <table class="round-table">
      <thead>
        <tr>
          <th>Round</th>
          <th>${players[0]}</th>
          <th>${players[1]}</th>
          <th class="team-separator">${players[2]}</th>
          <th>${players[3]}</th>
        </tr>
      </thead>
      <tbody>`;
  rounds.forEach((r, i) => {
    const locked = forceLock ? false : i < unlockedIndex;
    html += `<tr>
      <td>${i + 1}</td>
      ${[0, 2, 4, 6].map((p, idx) => `
        <td${idx === 2 ? ' class="team-separator"' : ''}>
          <div><strong>PNT</strong></div>
          <div class='input-group'>
            <button onclick='changeTeam(${i},${p},-1)' ${locked ? 'disabled' : ''}>-</button>
            <input type='number' value='${r[p]}' onchange='changeTeam(${i},${p},0)' ${locked ? 'disabled' : ''}>
            <button onclick='changeTeam(${i},${p},1)' ${locked ? 'disabled' : ''}>+</button>
          </div>
          <div><strong>CH</strong></div>
          <div class='input-group'>
            <button onclick='changeTeam(${i},${p+1},-1)' ${locked ? 'disabled' : ''}>-</button>
            <input type='number' value='${r[p+1]}' onchange='changeTeam(${i},${p+1},0)' ${locked ? 'disabled' : ''}>
            <button onclick='changeTeam(${i},${p+1},1)' ${locked ? 'disabled' : ''}>+</button>
          </div>
        </td>`).join('')}
    </tr>`;
  });
  
  html += `</tbody>
      <tfoot>`;
  if (rounds.length >= 5) {
    html += `
        <tr>
          <td></td>
          <td><strong>${players[0]}</strong></td>
          <td><strong>${players[1]}</strong></td>
          <td class="team-separator"><strong>${players[2]}</strong></td>
          <td><strong>${players[3]}</strong></td>
        </tr>`;
  }
  html += `
        <tr>
          <td>Total</td>
          ${[0, 2, 4, 6].map((p, idx) => {
            const pts = rounds.reduce((sum, r) => sum + r[p], 0);
            const ch = rounds.reduce((sum, r) => sum + r[p+1], 0);
            return `<td${idx === 2 ? ' class="team-separator"' : ''}>${pts} PNTS<br>${ch} CH</td>`;
          }).join('')}
        </tr>
        <tr>
          <td>Team Totals</td>
          <td colspan="2"><strong>${rounds.reduce((s, r) => s + r[0] + r[2], 0)} PNTS</strong></td>
          <td class="team-separator" colspan="2"><strong>${rounds.reduce((s, r) => s + r[4] + r[6], 0)} PNTS</strong></td>
        </tr>
        <tr>
          <td>Team CH Totals</td>
          <td colspan="2"><strong>${rounds.reduce((s, r) => s + r[1] + r[3], 0)} CH</strong></td>
          <td class="team-separator" colspan="2"><strong>${rounds.reduce((s, r) => s + r[5] + r[7], 0)} CH</strong></td>
        </tr>
      </tfoot>
    </table>
<br>
<button onclick="addTeamRound()">â• Add Round</button>`;
  document.getElementById('teamGame').innerHTML = html;
}
function clearHistory() {
  const code = prompt('Enter passcode to clear history:');
  if (code !== '010623') {
    document.getElementById('clearHistoryError').textContent = 'âŒ Incorrect passcode.';
    return;
  }
  if (confirm('Are you sure you want to clear all history?')) {
    localStorage.removeItem('cornholeHistory');
    location.reload();
  }
}
</script>
</body>
</html>
