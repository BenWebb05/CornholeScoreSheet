<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cornhole Scoreboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f0f0f0;
      padding: 20px;
    }
    h1 {
      text-align: center;
    }
    .center {
      text-align: center;
      margin: 20px;
    }
    table {
      width: 100%;
      max-width: 800px;
      margin: 0 auto 20px;
      border-collapse: collapse;
      background: white;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 10px;
      vertical-align: top;
      text-align: left;
    }
    input[type="number"] {
      width: 50px;
      text-align: center;
    }
    button {
      margin: 3px;
      padding: 2px 6px;
      cursor: pointer;
    }
    .totals {
      font-weight: bold;
    }
    .hidden {
      display: none;
    }
    .field-group {
      margin-bottom: 5px;
    }
    .flex-row {
      display: flex;
      align-items: center;
      gap: 4px;
      flex-wrap: nowrap;
    }
    .flex-row label {
      min-width: 30px;
      font-weight: bold;
    }
    .flex-row button {
      min-width: 28px;
      height: 28px;
      font-size: 20px;
      line-height: 20px;
      padding: 0;
      border-radius: 4px;
      border: 1px solid #888;
      background: #eee;
      user-select: none;
    }
    .locked {
      background-color: #ddd !important;
    }
    #unlockToggle {
      margin-bottom: 15px;
    }
  </style>
</head>
<body>

  <h1>Cornhole Scoreboard</h1>

  <div id="modeSelection" class="center">
    <p><strong>Choose Game Mode:</strong></p>
    <button onclick="selectMode('solos')">Solos</button>
    <button onclick="selectMode('teams')">Teams</button>
  </div>

  <!-- Solo Player Names -->
  <div id="soloNameForm" class="center hidden">
    <p><strong>Enter Player Names:</strong></p>
    <input type="text" id="player1Name" placeholder="Player 1" value="Ben" />
    <input type="text" id="player2Name" placeholder="Player 2" value="Dad" />
    <br /><br />
    <button onclick="startSoloGame()">Start Game</button>
  </div>

  <!-- Team Names -->
  <div id="teamNameForm" class="center hidden">
    <p><strong>Enter Team 1 Player Names:</strong></p>
    <input type="text" id="team1Player1" placeholder="Team 1 Player 1" value="Ben" />
    <input type="text" id="team1Player2" placeholder="Team 1 Player 2" value="Lilly" />
    <p><strong>Enter Team 2 Player Names:</strong></p>
    <input type="text" id="team2Player1" placeholder="Team 2 Player 1" value="Matt" />
    <input type="text" id="team2Player2" placeholder="Team 2 Player 2" value="Maddy" />
    <div class="field-group" style="margin-top:10px;">
      <input type="checkbox" id="individualPlayers" />
      <label for="individualPlayers">Track individual player points and cornholes</label>
    </div>
    <br />
    <button onclick="startTeamGame()">Start Game</button>
  </div>

  <div id="scoreboard" class="hidden">
    <div class="center">
      <button onclick="addRound()">‚ûï Add Round</button>
      <button onclick="resetGame()">üîÑ Reset</button>
      <button onclick="editNames()">‚úèÔ∏è Edit Names</button>
      <button id="unlockToggle" onclick="toggleUnlock()">üîì Unlock All Rounds</button>
    </div>

    <table>
      <thead>
        <tr id="headerRow">
          <!-- Filled dynamically -->
        </tr>
      </thead>
      <tbody id="scoreTable">
        <!-- rounds go here -->
      </tbody>
      <tfoot id="totalsFooter">
        <!-- Filled dynamically -->
      </tfoot>
    </table>
  </div>

<script>
  let mode = ""; // "solos" or "teams"
  let roundCount = 0;
  let trackIndividual = false;

  function selectMode(selectedMode) {
    mode = selectedMode;
    document.getElementById("modeSelection").classList.add("hidden");
    if (mode === "solos") {
      document.getElementById("soloNameForm").classList.remove("hidden");
    } else if (mode === "teams") {
      document.getElementById("teamNameForm").classList.remove("hidden");
    }
  }

  function startSoloGame() {
    trackIndividual = false; // solo mode no individual option
    const p1 = document.getElementById("player1Name").value || "Player 1";
    const p2 = document.getElementById("player2Name").value || "Player 2";
    setupScoreboard(p1, p2);
    document.getElementById("soloNameForm").classList.add("hidden");
    document.getElementById("scoreboard").classList.remove("hidden");
    resetGame();
    addRound();
  }

  function startTeamGame() {
    trackIndividual = document.getElementById("individualPlayers").checked;

    const t1p1 = document.getElementById("team1Player1").value.trim() || "Team1Player1";
    const t1p2 = document.getElementById("team1Player2").value.trim() || "Team1Player2";
    const t2p1 = document.getElementById("team2Player1").value.trim() || "Team2Player1";
    const t2p2 = document.getElementById("team2Player2").value.trim() || "Team2Player2";

    if (trackIndividual) {
      setupScoreboard(t1p1, t1p2, t2p1, t2p2);
    } else {
      const team1Name = `${t1p1} & ${t1p2}`;
      const team2Name = `${t2p1} & ${t2p2}`;
      setupScoreboard(team1Name, team2Name);
    }
    document.getElementById("teamNameForm").classList.add("hidden");
    document.getElementById("scoreboard").classList.remove("hidden");
    resetGame();
    addRound();
  }

  // Setup scoreboard headers and totals footer dynamically based on mode and trackIndividual
  function setupScoreboard(...names) {
    const headerRow = document.getElementById("headerRow");
    const totalsFooter = document.getElementById("totalsFooter");
    headerRow.innerHTML = "";
    totalsFooter.innerHTML = "";

    if (mode === "solos") {
      // Just Player 1 and Player 2 columns
      headerRow.innerHTML = `
        <th>Round</th>
        <th>${names[0]}</th>
        <th>${names[1]}</th>
      `;
      totalsFooter.innerHTML = `
        <tr class="totals">
          <td>Total Points</td>
          <td id="totalCol1">0</td>
          <td id="totalCol2">0</td>
        </tr>
        <tr class="totals">
          <td>Total Cornholes</td>
          <td id="totalCornholes1">0</td>
          <td id="totalCornholes2">0</td>
        </tr>
        <tr class="totals">
          <td>Total 4-Baggers</td>
          <td id="total4baggers1">0</td>
          <td id="total4baggers2">0</td>
        </tr>
      `;
    } else if (mode === "teams") {
      if (trackIndividual) {
        // Individual players: 4 columns
        headerRow.innerHTML = `
          <th>Round</th>
          <th>${names[0]} (T1)</th>
          <th>${names[1]} (T1)</th>
          <th>${names[2]} (T2)</th>
          <th>${names[3]} (T2)</th>
          <th>Team 1 Total</th>
          <th>Team 2 Total</th>
        `;
        totalsFooter.innerHTML = `
          <tr class="totals">
            <td>Total Points</td>
            <td id="totalCol1P1">0</td>
            <td id="totalCol1P2">0</td>
            <td id="totalCol2P1">0</td>
            <td id="totalCol2P2">0</td>
            <td id="totalTeam1">0</td>
            <td id="totalTeam2">0</td>
          </tr>
          <tr class="totals">
            <td>Total Cornholes</td>
            <td id="totalCornholes1P1">0</td>
            <td id="totalCornholes1P2">0</td>
            <td id="totalCornholes2P1">0</td>
            <td id="totalCornholes2P2">0</td>
            <td id="totalTeam1CH">0</td>
            <td id="totalTeam2CH">0</td>
          </tr>
          <tr class="totals">
            <td>Total 4-Baggers</td>
            <td colspan="4"></td>
            <td id="totalTeam14B">0</td>
            <td id="totalTeam24B">0</td>
          </tr>
        `;
      } else {
        // Just team totals: 2 columns
        headerRow.innerHTML = `
          <th>Round</th>
          <th>${names[0]}</th>
          <th>${names[1]}</th>
        `;
        totalsFooter.innerHTML = `
          <tr class="totals">
            <td>Total Points</td>
            <td id="totalCol1">0</td>
            <td id="totalCol2">0</td>
          </tr>
          <tr class="totals">
            <td>Total Cornholes</td>
            <td id="totalCornholes1">0</td>
            <td id="totalCornholes2">0</td>
          </tr>
          <tr class="totals">
            <td>Total 4-Baggers</td>
            <td id="total4baggers1">0</td>
            <td id="total4baggers2">0</td>
          </tr>
        `;
      }
    }
  }

  function addRound() {
    const table = document.getElementById("scoreTable");
    roundCount++;
    const row = document.createElement("tr");

    if (mode === "teams") {
      if (trackIndividual) {
        row.innerHTML = `
          <td>Round ${roundCount}</td>
          <td>
            <div class="flex-row">
              <label>Pts:</label>
              <button onclick="changeValue(this, -1)">‚Äì</button>
              <input type="number" value="0" min="0" onchange="updateTotals()" />
              <button onclick="changeValue(this, 1)">+</button>
            </div>
            <div class="flex-row">
              <label>CH:</label>
              <button onclick="changeValue(this, -1)">‚Äì</button>
              <input type="number" value="0" min="0" onchange="updateTotals()" />
              <button onclick="changeValue(this, 1)">+</button>
            </div>
          </td>
          <td>
            <div class="flex-row">
              <label>Pts:</label>
              <button onclick="changeValue(this, -1)">‚Äì</button>
              <input type="number" value="0" min="0" onchange="updateTotals()" />
              <button onclick="changeValue(this, 1)">+</button>
            </div>
            <div class="flex-row">
              <label>CH:</label>
              <button onclick="changeValue(this, -1)">‚Äì</button>
              <input type="number" value="0" min="0" onchange="updateTotals()" />
              <button onclick="changeValue(this, 1)">+</button>
            </div>
          </td>
          <td>
            <div class="flex-row">
              <label>Pts:</label>
              <button onclick="changeValue(this, -1)">‚Äì</button>
              <input type="number" value="0" min="0" onchange="updateTotals()" />
              <button onclick="changeValue(this, 1)">+</button>
            </div>
            <div class="flex-row">
              <label>CH:</label>
              <button onclick="changeValue(this, -1)">‚Äì</button>
              <input type="number" value="0" min="0" onchange="updateTotals()" />
              <button onclick="changeValue(this, 1)">+</button>
            </div>
          </td>
          <td>
            <div class="flex-row">
              <label>Pts:</label>
              <button onclick="changeValue(this, -1)">‚Äì</button>
              <input type="number" value="0" min="0" onchange="updateTotals()" />
              <button onclick="changeValue(this, 1)">+</button>
            </div>
            <div class="flex-row">
              <label>CH:</label>
              <button onclick="changeValue(this, -1)">‚Äì</button>
              <input type="number" value="0" min="0" onchange="updateTotals()" />
              <button onclick="changeValue(this, 1)">+</button>
            </div>
          </td>
          <td><span class="team1TotalPts">0</span></td>
          <td><span class="team2TotalPts">0</span></td>
        `;
      } else {
        row.innerHTML = `
          <td>Round ${roundCount}</td>
          <td>
            <div class="flex-row">
              <label>Pts:</label>
              <button onclick="changeValue(this, -1)">‚Äì</button>
              <input type="number" value="0" min="0" onchange="updateTotals()" />
              <button onclick="changeValue(this, 1)">+</button>
            </div>
            <div class="flex-row">
              <label>CH:</label>
              <button onclick="changeValue(this, -1)">‚Äì</button>
              <input type="number" value="0" min="0" onchange="updateTotals()" />
              <button onclick="changeValue(this, 1)">+</button>
            </div>
          </td>
          <td>
            <div class="flex-row">
              <label>Pts:</label>
              <button onclick="changeValue(this, -1)">‚Äì</button>
              <input type="number" value="0" min="0" onchange="updateTotals()" />
              <button onclick="changeValue(this, 1)">+</button>
            </div>
            <div class="flex-row">
              <label>CH:</label>
              <button onclick="changeValue(this, -1)">‚Äì</button>
              <input type="number" value="0" min="0" onchange="updateTotals()" />
              <button onclick="changeValue(this, 1)">+</button>
            </div>
          </td>
        `;
      }
    } else {
      // solos mode with 4-bagger checkbox
      row.innerHTML = `
        <td>Round ${roundCount}</td>
        <td>
          <div class="flex-row">
            <label>Pts:</label>
            <button onclick="changeValue(this, -1)">‚Äì</button>
            <input type="number" value="0" min="0" onchange="updateTotals()" />
            <button onclick="changeValue(this, 1)">+</button>
          </div>
          <div class="flex-row">
            <label>CH:</label>
            <button onclick="changeValue(this, -1)">‚Äì</button>
            <input type="number" value="0" min="0" onchange="updateTotals()" />
            <button onclick="changeValue(this, 1)">+</button>
          </div>
          <div class="field-group">
            4-Bagger: <input type="checkbox" onchange="updateTotals()" />
          </div>
        </td>
        <td>
          <div class="flex-row">
            <label>Pts:</label>
            <button onclick="changeValue(this, -1)">‚Äì</button>
            <input type="number" value="0" min="0" onchange="updateTotals()" />
            <button onclick="changeValue(this, 1)">+</button>
          </div>
          <div class="flex-row">
            <label>CH:</label>
            <button onclick="changeValue(this, -1)">‚Äì</button>
            <input type="number" value="0" min="0" onchange="updateTotals()" />
            <button onclick="changeValue(this, 1)">+</button>
          </div>
          <div class="field-group">
            4-Bagger: <input type="checkbox" onchange="updateTotals()" />
          </div>
        </td>
      `;
    }

    table.appendChild(row);
    lockPreviousRounds(); // lock all but last round
    updateTotals();
  }

  function lockPreviousRounds() {
    const rows = document.querySelectorAll("#scoreTable tr");

    // Unlock all first
    rows.forEach(row => {
      Array.from(row.querySelectorAll("input, button")).forEach(el => {
        el.disabled = false;
        el.classList.remove("locked");
      });
    });

    // Lock all but last
    for (let i = 0; i < rows.length - 1; i++) {
      const inputs = rows[i].querySelectorAll("input, button");
      inputs.forEach(input => {
        input.disabled = true;
        input.classList.add("locked");
      });
    }
  }

  function toggleUnlock() {
    const rows = document.querySelectorAll("#scoreTable tr");
    const unlockBtn = document.getElementById("unlockToggle");

    // Check if first round inputs are disabled to decide current state
    const currentlyLocked = rows.length > 1 && rows[0].querySelector("input, button").disabled;

    if (currentlyLocked) {
      // Unlock all
      rows.forEach(row => {
        Array.from(row.querySelectorAll("input, button")).forEach(el => {
          el.disabled = false;
          el.classList.remove("locked");
        });
      });
      unlockBtn.textContent = "üîí Lock All Rounds";
    } else {
      // Lock all but last round
      lockPreviousRounds();
      unlockBtn.textContent = "üîì Unlock All Rounds";
    }
  }

  function changeValue(button, delta) {
    const input = button.parentElement.querySelector("input[type='number']");
    if (!input) return;
    let newValue = parseInt(input.value) + delta;
    if (newValue < 0) newValue = 0;
    input.value = newValue;
    updateTotals();
  }

  function updateTotals() {
    const rows = document.querySelectorAll("#scoreTable tr");

    if (mode === "solos") {
      let totalPts1 = 0, totalPts2 = 0;
      let totalCH1 = 0, totalCH2 = 0;
      let total4B1 = 0, total4B2 = 0;

      rows.forEach(row => {
        const tds = row.querySelectorAll("td");
        if (tds.length < 3) return;

        // Player 1
        const inputs1 = tds[1].querySelectorAll("input[type='number']");
        const chkbox1 = tds[1].querySelector("input[type='checkbox']");
        const pts1 = inputs1[0] ? parseInt(inputs1[0].value) || 0 : 0;
        const ch1 = inputs1[1] ? parseInt(inputs1[1].value) || 0 : 0;
        const b4_1 = chkbox1 && chkbox1.checked ? 1 : 0;

        // Player 2
        const inputs2 = tds[2].querySelectorAll("input[type='number']");
        const chkbox2 = tds[2].querySelector("input[type='checkbox']");
        const pts2 = inputs2[0] ? parseInt(inputs2[0].value) || 0 : 0;
        const ch2 = inputs2[1] ? parseInt(inputs2[1].value) || 0 : 0;
        const b4_2 = chkbox2 && chkbox2.checked ? 1 : 0;

        totalPts1 += pts1;
        totalCH1 += ch1;
        total4B1 += b4_1;

        totalPts2 += pts2;
        totalCH2 += ch2;
        total4B2 += b4_2;
      });

      document.getElementById("totalCol1").textContent = totalPts1;
      document.getElementById("totalCol2").textContent = totalPts2;

      document.getElementById("totalCornholes1").textContent = totalCH1;
      document.getElementById("totalCornholes2").textContent = totalCH2;

      document.getElementById("total4baggers1").textContent = total4B1;
      document.getElementById("total4baggers2").textContent = total4B2;

    } else if (mode === "teams") {
      if (trackIndividual) {
        // Per player totals:
        let t1p1Pts=0, t1p2Pts=0, t2p1Pts=0, t2p2Pts=0;
        let t1p1CH=0, t1p2CH=0, t2p1CH=0, t2p2CH=0;

        let t1TeamPts=0, t2TeamPts=0;
        let t1TeamCH=0, t2TeamCH=0;
        let t1Team4B=0, t2Team4B=0;

        rows.forEach(row => {
          const tds = row.querySelectorAll("td");
          if (tds.length < 7) return;

          // Team 1 Player 1 inputs
          const t1p1inputs = tds[1].querySelectorAll("input[type='number']");
          const t1p1pts = t1p1inputs[0] ? parseInt(t1p1inputs[0].value) || 0 : 0;
          const t1p1ch = t1p1inputs[1] ? parseInt(t1p1inputs[1].value) || 0 : 0;

          // Team 1 Player 2 inputs
          const t1p2inputs = tds[2].querySelectorAll("input[type='number']");
          const t1p2pts = t1p2inputs[0] ? parseInt(t1p2inputs[0].value) || 0 : 0;
          const t1p2ch = t1p2inputs[1] ? parseInt(t1p2inputs[1].value) || 0 : 0;

          // Team 2 Player 1 inputs
          const t2p1inputs = tds[3].querySelectorAll("input[type='number']");
          const t2p1pts = t2p1inputs[0] ? parseInt(t2p1inputs[0].value) || 0 : 0;
          const t2p1ch = t2p1inputs[1] ? parseInt(t2p1inputs[1].value) || 0 : 0;

          // Team 2 Player 2 inputs
          const t2p2inputs = tds[4].querySelectorAll("input[type='number']");
          const t2p2pts = t2p2inputs[0] ? parseInt(t2p2inputs[0].value) || 0 : 0;
          const t2p2ch = t2p2inputs[1] ? parseInt(t2p2inputs[1].value) || 0 : 0;

          // Update individual totals
          t1p1Pts += t1p1pts;
          t1p1CH += t1p1ch;
          t1p2Pts += t1p2pts;
          t1p2CH += t1p2ch;
          t2p1Pts += t2p1pts;
          t2p1CH += t2p1ch;
          t2p2Pts += t2p2pts;
          t2p2CH += t2p2ch;

          // Update team totals (sum of players)
          const t1TotalPts = t1p1pts + t1p2pts;
          const t2TotalPts = t2p1pts + t2p2pts;

          const t1TotalCH = t1p1ch + t1p2ch;
          const t2TotalCH = t2p1ch + t2p2ch;

          // Update team totals cell in row
          tds[5].textContent = t1TotalPts;
          tds[6].textContent = t2TotalPts;

          // Sum across rounds for total teams:
          t1TeamPts += t1TotalPts;
          t2TeamPts += t2TotalPts;
          t1TeamCH += t1TotalCH;
          t2TeamCH += t2TotalCH;
          // 4-baggers don't apply individually for teams with players separate here
        });

        // Update footer totals for players
        document.getElementById("totalCol1P1").textContent = t1p1Pts;
        document.getElementById("totalCol1P2").textContent = t1p2Pts;
        document.getElementById("totalCol2P1").textContent = t2p1Pts;
        document.getElementById("totalCol2P2").textContent = t2p2Pts;

        // Update footer totals for teams
        document.getElementById("totalTeam1").textContent = t1TeamPts;
        document.getElementById("totalTeam2").textContent = t2TeamPts;

        // Update footer cornholes totals
        document.getElementById("totalCornholes1P1").textContent = t1p1CH;
        document.getElementById("totalCornholes1P2").textContent = t1p2CH;
        document.getElementById("totalCornholes2P1").textContent = t2p1CH;
        document.getElementById("totalCornholes2P2").textContent = t2p2CH;

        document.getElementById("totalTeam1CH").textContent = t1TeamCH;
        document.getElementById("totalTeam2CH").textContent = t2TeamCH;

        // 4-baggers totals for teams when players separated don't exist - set 0
        document.getElementById("totalTeam14B").textContent = 0;
        document.getElementById("totalTeam24B").textContent = 0;

      } else {
        // Teams without individual players
        let totalPts1 = 0, totalPts2 = 0;
        let totalCH1 = 0, totalCH2 = 0;
        let total4B1 = 0, total4B2 = 0;

        rows.forEach(row => {
          const tds = row.querySelectorAll("td");
          if (tds.length < 3) return;

          // Team 1
          const inputs1 = tds[1].querySelectorAll("input[type='number']");
          const pts1 = inputs1[0] ? parseInt(inputs1[0].value) || 0 : 0;
          const ch1 = inputs1[1] ? parseInt(inputs1[1].value) || 0 : 0;

          // Team 2
          const inputs2 = tds[2].querySelectorAll("input[type='number']");
          const pts2 = inputs2[0] ? parseInt(inputs2[0].value) || 0 : 0;
          const ch2 = inputs2[1] ? parseInt(inputs2[1].value) || 0 : 0;

          totalPts1 += pts1;
          totalCH1 += ch1;

          totalPts2 += pts2;
          totalCH2 += ch2;
        });

        document.getElementById("totalCol1").textContent = totalPts1;
        document.getElementById("totalCol2").textContent = totalPts2;

        document.getElementById("totalCornholes1").textContent = totalCH1;
        document.getElementById("totalCornholes2").textContent = totalCH2;

        // No 4-bagger checkbox in team mode without individual tracking, so 0:
        document.getElementById("total4baggers1").textContent = 0;
        document.getElementById("total4baggers2").textContent = 0;
      }
    }
  }

  function resetGame() {
    roundCount = 0;
    document.getElementById("scoreTable").innerHTML = "";
    updateTotals();
  }

  function editNames() {
    if (mode === "solos") {
      const newP1 = prompt("Enter new name for Player 1:", document.getElementById("headerRow").children[1].textContent);
      const newP2 = prompt("Enter new name for Player 2:", document.getElementById("headerRow").children[2].textContent);
      if (newP1) document.getElementById("headerRow").children[1].textContent = newP1;
      if (newP2) document.getElementById("headerRow").children[2].textContent = newP2;
    } else {
      if (trackIndividual) {
        for (let i=1; i<=4; i++) {
          const newName = prompt(`Enter new name for ${document.getElementById("headerRow").children[i].textContent}:`, document.getElementById("headerRow").children[i].textContent);
          if (newName) document.getElementById("headerRow").children[i].textContent = newName;
        }
      } else {
        const newT1 = prompt("Enter new name for Team 1:", document.getElementById("headerRow").children[1].textContent);
        const newT2 = prompt("Enter new name for Team 2:", document.getElementById("headerRow").children[2].textContent);
        if (newT1) document.getElementById("headerRow").children[1].textContent = newT1;
        if (newT2) document.getElementById("headerRow").children[2].textContent = newT2;
      }
    }
  }
</script>

</body>
</html>
